(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{303:function(e,t,r){},457:function(e,t){},459:function(e,t){},470:function(e,t){},472:function(e,t){},500:function(e,t){},501:function(e,t){},506:function(e,t){},508:function(e,t){},515:function(e,t){},534:function(e,t){},564:function(e,t,r){"use strict";r.r(t);var a=r(0),s=r.n(a),n=r(281),i=r.n(n),l=(r(303),r(7)),o=r(282);const c=r.n(o).a.create({baseURL:"http://localhost:8080"});c.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e}),(e=>Promise.reject(e))),c.interceptors.request.use((e=>e),Promise.reject),c.interceptors.response.use((e=>e),(e=>Promise.reject(e)));var d=c;const u=new Set,j={initAuthoritySet:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JSON.parse(localStorage.getItem("user")||"{}");(e&&e.roles?e.roles:[]).forEach((e=>{e.authorities.forEach((e=>{u.add(e.name)}))}))},hasAuthority:e=>(j.initAuthoritySet(),u.has(e)),hasAuthorities:e=>{j.initAuthoritySet();for(const t of e)if(!u.has(t))return!1;return!0},hasAnyAuthority:e=>{for(const t of e)if(u.has(t))return!0;return!1},clearAuthorities:()=>{u.clear()}};var h=j;var b={getUser:async e=>{const{data:t}=await d.get("/user/".concat(e));return t},updateUser:e=>d.put("/user/".concat(e.id),e),addUser:async e=>d.post("/user/registerUser",e).then((e=>e.data)),getAllUsers:()=>d.get("/user"),deleteUser:e=>d.delete("/user/".concat(e))},m=r(1);const g="user",p="token",O=()=>{throw new Error("No provider for the ActiveUserContext found")},x={user:null,login:O,logout:O,setActiveUser:O,loadActiveUser:O,checkRole:O},f=Object(a.createContext)(x);var v=f;const S=e=>{let{children:t}=e;const[r,s]=Object(a.useState)((()=>(()=>{const e=localStorage.getItem(g);return null===e?null:JSON.parse(e)})())),n=Object(l.p)(),i=e=>{s(e),localStorage.setItem(g,JSON.stringify(e))},o=()=>{h.clearAuthorities(),localStorage.clear(),s(null)},c=()=>r?b.getUser(r.id).then((e=>{i(e)})):null;return Object(a.useEffect)((()=>{null!==localStorage.getItem(p)&&c()}),[]),Object(a.useEffect)((()=>{null!==r&&(h.initAuthoritySet(r),localStorage.setItem(g,JSON.stringify(r)))}),[r]),Object(m.jsx)("div",{children:Object(m.jsx)(f.Provider,{value:{user:r,setActiveUser:i,login:async(e,t)=>(await d.post("user/login",{email:e,password:t}).then((e=>(console.log(e.headers.authorization),localStorage.setItem(p,e.headers.authorization),i(e.data),!0))),!1),logout:()=>{null!==localStorage.getItem(p)?(d.get("/logout").finally(o),n("/login")):o()},loadActiveUser:c,checkRole:function(e){return!!r&&r.roles.some((t=>t.name===e))}},children:t})})};var y=r(623),A=r(624),E=r(617),U=r(622),C=r(632),P=r(626),w=r(61),R=r(29);const N=R.object().shape({email:R.string(),password:R.string()});var D,I=()=>{const e={margin:"8px 0"},t=Object(l.p)(),{login:r}=Object(a.useContext)(v);return Object(m.jsx)(y.a,{children:Object(m.jsxs)(A.a,{elevation:10,style:{padding:20,height:"70vh",width:280,margin:"20px auto"},children:[Object(m.jsxs)(y.a,{children:[Object(m.jsx)("h2",{children:"Sign In"}),Object(m.jsx)("p",{children:"Default login:"}),Object(m.jsx)("p",{children:"email: admin@example.com"}),Object(m.jsx)("p",{children:"pw: 1234"})]}),Object(m.jsx)(w.b,{initialValues:{email:"",password:""},enableReinitialize:!0,validationSchema:N,onSubmit:e=>{r(e.email.toLowerCase(),e.password).then((()=>{console.log("navigate",e),t("/userprofile/me")})).catch((e=>{"undefined"!==typeof e.response&&401===e.response.status||403===e.response.status?alert("invalid login"):alert("login Error")}))},validateOnChange:!0,isInitialValid:!0,children:t=>Object(m.jsxs)(w.a,{onSubmit:t.handleSubmit,children:[Object(m.jsx)(E.a,{label:"email",id:"email","data-cy":"email",placeholder:"Enter username",fullWidth:!0,required:!0,autoFocus:!0,onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.email}),t.errors.email&&Object(m.jsx)("div",{id:"feedback",children:t.errors.email}),Object(m.jsx)(E.a,{id:"password",label:"password","data-cy":"password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0,onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.password}),t.errors.password&&Object(m.jsx)("div",{id:"feedback",children:t.errors.password}),Object(m.jsx)(U.a,{type:"submit","data-cy":"submit-login",color:"primary",variant:"contained",style:e,fullWidth:!0,children:"Sign in"})]})}),Object(m.jsx)(C.a,{children:Object(m.jsx)(P.a,{href:"#",children:"Forgot password ?"})}),Object(m.jsxs)(C.a,{children:[" ","Do you have an account ?",Object(m.jsx)(P.a,{href:"#",children:"Sign Up"})]})]})})},T=r(288);!function(e){e.USER_CREATE="USER_CREATE",e.USER_READ="USER_READ",e.USER_DEACTIVATE="USER_DEACTIVATE",e.DEFAULT="DEFAULT",e.USER_MODIFY="USER_MODIFY",e.USER_DELETE="USER_DELETE"}(D||(D={}));var B=D;var _=e=>{let{requiredAuths:t,element:r}=e;const s=Object(l.p)(),n=Object(a.useContext)(v);if(!(()=>{let e=localStorage.getItem("token");if(!e)return console.error("no token found"),!1;e=e.replace("Bearer ","");const t=T.decode(e);return!(!t||!t.exp||t.exp<Date.now()/1e3)})())return n.logout(),Object(m.jsx)(l.a,{to:"/login",replace:!0});return 0===t.length||t.some(h.hasAuthority)?h.hasAuthority(B.USER_MODIFY)?Object(m.jsxs)("div",{children:[Object(m.jsx)(U.a,{onClick:n.logout,children:"Logout"}),Object(m.jsx)(U.a,{onClick:()=>s("/userprofile/all"),children:"Admin Overview"}),r]}):Object(m.jsxs)("div",{children:[Object(m.jsx)(U.a,{onClick:n.logout,children:"Logout"}),r]}):Object(m.jsx)(l.a,{to:"/unauthorized",replace:!0})},k=r(614),q=r.p+"static/media/logo1.a04327d3.png";function z(){return Object(m.jsxs)(k.a,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(m.jsx)("h1",{children:"Welcome to the Homepage"}),Object(m.jsx)("img",{src:q,style:{filter:"invert(100%)"},className:"App-logo",alt:"logo"})]})}var F=r(627),L=r(629),V=r(628);var M=()=>{const e=Object(l.p)(),[t,r]=Object(a.useState)([]);Object(a.useEffect)((()=>{b.getAllUsers().then((e=>{r(e.data)}))}),[]);return Object(m.jsxs)(m.Fragment,{children:[t.map((t=>Object(m.jsx)("div",{children:Object(m.jsx)(F.a,{sx:{minWidth:275},children:Object(m.jsxs)(V.a,{children:[t.firstName," ",t.lastName," ",t.email,Object(m.jsxs)(L.a,{children:[Object(m.jsx)(U.a,{size:"small",color:"primary",variant:"contained",onClick:()=>{return r=t.id,void e("../useredit/"+r);var r},children:"Edit"}),Object(m.jsx)(U.a,{size:"small",color:"error",variant:"contained",onClick:()=>{return e=t.id,void b.deleteUser(e);var e},children:"Delete"})]})]})})},t.id))),Object(m.jsx)(U.a,{size:"small",color:"success",variant:"contained",onClick:()=>{e("../useredit/")},children:"Add"})]})},J=r(615);var Z=e=>{let{user:t,submitActionHandler:r}=e;const a=Object(l.p)(),s=Object(w.c)({initialValues:{id:t.id,lastName:t?t.lastName:"",firstName:t?t.firstName:"",email:t?t.email:"",userProfile:t?t.userProfile:{id:""},roles:t?t.roles:[]},validationSchema:Object(R.object)({firstName:Object(R.string)().required().min(2).max(50),lastName:Object(R.string)().required().min(2).max(50),email:Object(R.string)().required().email()}),onSubmit:e=>{r(e)},enableReinitialize:!0});return Object(m.jsxs)("form",{onSubmit:s.handleSubmit,children:[Object(m.jsxs)(J.a,{sx:{paddingTop:"15px"},children:[Object(m.jsx)(E.a,{id:"firstName",label:"Firstname",variant:"outlined",sx:{paddingRight:"10px"},onBlur:s.handleBlur,onChange:s.handleChange,error:Boolean(s.touched.firstName&&s.errors.firstName),value:s.values.firstName}),s.errors.firstName&&s.touched.firstName?Object(m.jsx)("div",{style:{color:"red"},children:s.errors.firstName}):null,Object(m.jsx)(E.a,{id:"lastName",label:"Lastname",variant:"outlined",sx:{paddingRight:"10px"},onBlur:s.handleBlur,onChange:s.handleChange,error:Boolean(s.touched.lastName&&s.errors.lastName),value:s.values.lastName}),s.errors.lastName&&s.touched.lastName?Object(m.jsx)("div",{style:{color:"red"},children:s.errors.lastName}):null,Object(m.jsx)(E.a,{id:"email",label:"E-Mail",variant:"outlined",onBlur:s.handleBlur,onChange:s.handleChange,error:Boolean(s.touched.email&&s.errors.email),value:s.values.email}),s.errors.email&&s.touched.email?Object(m.jsx)("div",{style:{color:"red"},children:s.errors.email}):null]}),Object(m.jsxs)("div",{children:[Object(m.jsxs)(U.a,{sx:{marginTop:"15px",marginRight:"10px"},variant:"contained",color:"success",type:"submit",disabled:!(s.dirty&&s.isValid),children:[t.id&&"Save",!t.id&&"Add"]}),Object(m.jsx)(U.a,{sx:{marginTop:"15px"},variant:"contained",color:"error",onClick:()=>{a("/users")},children:"Cancel"})]})]})};var H=()=>{const e=Object(l.p)(),{userId:t}=Object(l.r)(),[r,s]=Object(a.useState)({userProfile:{id:""},id:"",firstName:"",lastName:"",email:"",roles:[]});Object(a.useEffect)((()=>()=>{t&&b.getUser(t).then((e=>s(e)))}),[t]);return Object(m.jsx)(Z,{user:r,submitActionHandler:r=>{void 0!==t?b.updateUser(r).then((()=>{e("../users")})):b.addUser(r).then((()=>{e("/users")}))}})};var W={getUserProfile:async e=>(await d.get("/userprofile/".concat(e))).data,getAllUserProfiles:async(e,t,r)=>{r=""===r?"":"&sort="+r;return(await d.get("/userprofile?limit=".concat(t,"&offset=").concat(e).concat(r))).data},addUserProfile:async(e,t)=>(await d.post("/userprofile/".concat(t),e)).data,deleteUser:e=>d.delete("/userprofile/".concat(e)),getAllUsers:()=>d.get("/userprofile"),updateUserProfile:e=>d.put("/userprofile/".concat(e.id),e)};const Y=R.object().shape({username:R.string().required("required").min(1,"min. 1 letter").max(50,"max. 50 letters"),address:R.string().min(3,"min. 3 letters").max(50,"max. 50 letters"),birthday:R.string().nullable().test("Check Max Date","Date is invalid.",(e=>{const t=e?new Date(e):new Date;t.setHours(0,0,0,0);let r=new Date;return r.setHours(0,0,0,0),!e||r>=t})),profilePicture:R.string().url("Invalid URL format.")});var G=e=>{let{userProfile:t,isDisabled:r}=e;const{user:s}=Object(a.useContext)(v),n=Object(w.c)({initialValues:{id:t?t.id:"",username:t?t.username:"",address:t?t.address:"",birthday:t&&t.birthday?(e=>{const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)})(new Date(t.birthday)):"",profilePicture:t?t.profilePicture:""},validationSchema:Y,onSubmit:e=>{console.log(e),(e=>{try{const t={...e,birthday:e.birthday?new Date(e.birthday):void 0};e.username?W.updateUserProfile(t).then((()=>{console.log("UserProfile Updated")})):s&&W.addUserProfile(t,null===s||void 0===s?void 0:s.id).then((()=>{console.log("UserProfile Created")}))}catch(t){console.log(t)}})(e)},enableReinitialize:!0,validateOnChange:!0});return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:n.handleSubmit,children:[Object(m.jsxs)(k.a,{sx:{paddingTop:"30px"},children:[Object(m.jsx)(E.a,{id:"profilePicture",name:"profilePicture",label:"Profilpicture URL",variant:"outlined",value:n.values.profilePicture,onChange:n.handleChange,error:n.touched.profilePicture&&Boolean(n.errors.profilePicture),helperText:n.errors.profilePicture,disabled:r}),Object(m.jsx)(E.a,{required:!0,id:"username",name:"username",label:"Username",variant:"outlined",value:n.values.username,onChange:n.handleChange,error:n.touched.username&&Boolean(n.errors.username),helperText:n.errors.username,disabled:r}),Object(m.jsx)(E.a,{id:"address",name:"address",label:"Address",variant:"outlined",value:n.values.address,onChange:n.handleChange,error:n.touched.address&&Boolean(n.errors.address),helperText:n.errors.address,disabled:r}),Object(m.jsx)(E.a,{id:"birthday",name:"birthday",label:"Birthday",variant:"outlined",value:n.values.birthday,onChange:n.handleChange,error:n.touched.birthday&&Boolean(n.errors.birthday),helperText:n.errors.birthday,disabled:r})]}),Object(m.jsx)("div",{children:!r&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(U.a,{sx:{marginTop:"15px",marginRight:"10px"},variant:"outlined",type:"submit",disabled:!n.isValid,children:"Save"}),Object(m.jsx)(U.a,{sx:{marginTop:"15px",marginRight:"10px"},variant:"contained",color:"error",onClick:()=>(e=>{try{void 0!==e&&W.deleteUser(e).then((()=>{console.log("UserProfile Deleted")}))}catch(t){console.log(t)}})(null===t||void 0===t?void 0:t.id),disabled:!n.values,children:"Delete"})]})})]})})};var K=function(){const{user:e}=Object(a.useContext)(v),[t,r]=Object(a.useState)();return Object(a.useEffect)((()=>()=>{void 0!==e&&null!==e&&null!==e.userProfile&&"string"===typeof e.userProfile.id&&W.getUserProfile(e.userProfile.id).then((e=>{r(e),console.log(e)})),console.log("Get User with Context",e)}),[]),Object(m.jsx)("div",{children:Object(m.jsx)(G,{userProfile:t,isDisabled:!1})})};const Q={sort:"",setSort:()=>{},currentPage:1,setCurrentPage:()=>{},setPageInfo:()=>{},pageInfo:{totalPages:0,totalElements:0,pageable:{pageNumber:0,pageSize:10,sort:{sorted:!1,unsorted:!1,empty:!0},offset:0,paged:!1,unpaged:!1},size:0,content:[],number:0,sort:{sorted:!1,unsorted:!1,empty:!0},numberOfElements:0,first:!1,last:!1,empty:!0}},X=Object(a.createContext)(Q);var $=e=>{let{children:t}=e;const[r,s]=Object(a.useState)(1),[n,i]=Object(a.useState)(""),[l,o]=Object(a.useState)({totalPages:0,totalElements:0,pageable:{pageNumber:0,pageSize:10,sort:{sorted:!1,unsorted:!1,empty:!0},offset:0,paged:!1,unpaged:!1},size:0,content:[],number:0,sort:{sorted:!1,unsorted:!1,empty:!0},numberOfElements:0,first:!1,last:!1,empty:!0});return Object(m.jsx)(X.Provider,{value:{sort:n,setSort:i,currentPage:r,setCurrentPage:s,pageInfo:l,setPageInfo:o},children:t})},ee=r(619);var te=function(){const{currentPage:e,setCurrentPage:t,pageInfo:r}=Object(a.useContext)(X);return Object(m.jsx)(ee.a,{count:r.totalPages,color:"primary",page:e,onChange:(e,r)=>t(r)})};var re=function(){const{sort:e,currentPage:t,setPageInfo:r,pageInfo:s}=Object(a.useContext)(X);return Object(a.useEffect)((()=>{W.getAllUserProfiles(t-1,s.pageable.pageSize,e).then((e=>{r({...e})}))}),[r,t,e,s.pageable.pageSize]),Object(m.jsx)("div",{"data-cy":"people-list-item",children:s.content.map((e=>Object(m.jsx)(G,{userProfile:e,isDisabled:!0},e.username)))})},ae=r(616),se=r(620);var ne=function(){const{setSort:e}=Object(a.useContext)(X),[t,r]=Object(a.useState)("username_asc");return Object(a.useEffect)((()=>{e(t)}),[e,t]),Object(m.jsxs)(ae.a,{labelId:"sort","data-cy":"sort-dropdown",id:"sort",value:t,label:"Sort",onChange:e=>r(e.target.value),children:[Object(m.jsx)(se.a,{value:"address_desc",children:"Address A-Z"}),Object(m.jsx)(se.a,{value:"address_asc",children:"Address Z-A"}),Object(m.jsx)(se.a,{value:"birthday_desc",children:"Birthday Z-A"}),Object(m.jsx)(se.a,{value:"birthday_asc",children:"Birthday A-Z"}),Object(m.jsx)(se.a,{value:"username_asc",children:"Username A-Z"}),Object(m.jsx)(se.a,{value:"username_desc",children:"Username Z-A"})]})};var ie=function(){return Object(m.jsxs)($,{children:[Object(m.jsx)(ne,{}),Object(m.jsx)(re,{}),Object(m.jsx)(te,{})]})};var le=()=>Object(m.jsxs)(l.d,{children:[Object(m.jsx)(l.b,{path:"/",element:Object(m.jsx)(z,{})}),Object(m.jsx)(l.b,{path:"/login",element:Object(m.jsx)(I,{})}),Object(m.jsx)(l.b,{path:"/userprofile/me",element:Object(m.jsx)(_,{requiredAuths:[],element:Object(m.jsx)(K,{})})}),Object(m.jsx)(l.b,{path:"/userprofile/all",element:Object(m.jsx)(_,{requiredAuths:[B.USER_MODIFY],element:Object(m.jsx)(ie,{})})}),Object(m.jsx)(l.b,{path:"/users",element:Object(m.jsx)(_,{requiredAuths:[],element:Object(m.jsx)(M,{})})}),Object(m.jsx)(l.b,{path:"/useredit",element:Object(m.jsx)(_,{requiredAuths:[B.USER_DEACTIVATE,B.USER_CREATE],element:Object(m.jsx)(H,{})})}),Object(m.jsx)(l.b,{path:"/useredit/:userId",element:Object(m.jsx)(_,{requiredAuths:[B.USER_READ],element:Object(m.jsx)(H,{})})}),Object(m.jsx)(l.b,{path:"*",element:Object(m.jsx)("div",{children:"Not Found"})})]});var oe=function(){return Object(m.jsx)(S,{children:Object(m.jsx)(le,{})})},ce=r(43);i.a.createRoot(document.getElementById("root")).render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(ce.a,{children:Object(m.jsx)(oe,{})})}))}},[[564,1,2]]]);
//# sourceMappingURL=main.85a1f5ef.chunk.js.map